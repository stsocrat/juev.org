<!DOCTYPE html>
<!--
    You can email me with PGP-key: 0xE8ADA1A55B3CA4EA
-->
<html lang="ru">
<head>
  <link rel="dns-prefetch" href="https://static.juev.org">
  <meta charset="utf-8">
  <title>Публикация сайтов на GitHub</title>
  <meta name="description" content="OpenShift по умолчанию предоставляет возможность использовать на своем аккаунте только три приложения.  И как указывается в FAQ, для использования большего числа приложений необходимо просто зареги...">
  <meta name="yandex-verification" content="59bb4b98872e096b" />
  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- end -->
  <link rel="canonical" href="https://www.juev.org/2012/06/08/github/">
  <link rel="shortcut icon" href="https://static.juev.org/favicon.ico">
  <link rel="apple-touch-icon" href="https://www.juev.org/apple-touch-icon.png">
  <link rel="alternate" type="application/atom+xml" title="ATOM Feed" href="https://www.juev.org/atom.xml">
  <link rel="stylesheet" type="text/css" href="https://static.juev.org/assets/css/master.6bbfa8b61.css">
  <link rel="prev" href="https://www.juev.org/2012/05/28/jekyll-in-openshift/">
  <link rel="next" href="https://www.juev.org/2012/06/09/ipod/">
  <!-- og:meta -->
  <meta content="Публикация сайтов на GitHub" property="og:title">
  <meta content="OpenShift по умолчанию предоставляет возможность использовать на своем аккаунте только три приложения.  И как указывается в FAQ, для использования большего числа приложений необходимо просто зареги..." property="og:description">
  <meta content="https://www.juev.org/2012/06/08/github/" property="og:url">
  <meta content="2012-06-08T10:35:00+04:00" property="article:published_time">
  <meta content="github" property="article:tag">
  <meta content="git" property="article:tag">
  <meta content="web" property="article:tag">
  <meta content="jekyll" property="article:tag">
  <meta content="https://static.juev.org/images/calvin.png" property="og:image">
  <meta content="https://denis.evsyukov.org" property="article:author">
  <!-- end og:meta  -->
  <!-- twitter card -->
  <meta content="summary_large_image" name="twitter:card">
  <meta content="Публикация сайтов на GitHub" name="twitter:title">
  <meta content="OpenShift по умолчанию предоставляет возможность использовать на своем аккаунте только три приложения.  И как указывается в FAQ, для использования большего числа приложений необходимо просто зареги..." property="twitter:description">
  <meta content="https://www.juev.org/2012/06/08/github/" name="twitter:url">
  <meta content="https://static.juev.org/images/calvin.png" property="twitter:image:src">
  <!-- end twitter card -->
</head>
<body class="wide">
  <div class="navigation">
    <div class="width-fix">
        <a href="https://www.juev.org/" id="home" rel="nofollow"></a>
      <ul>
        <li><a href="https://www.juev.org/articles.html" rel="nofollow">Статьи</a></li>
        <li>|</li>
        <li><a href="https://denis.evsyukov.org">Об авторе</a></li>
      </ul>
    </div>
  </div>
  <div class="primary-content width-fix">
    <div class="entry"><h1 class="title">Публикация сайтов на GitHub</h1>
<div id="metainfo">
<span class="date">08 June 2012</span>
<span class="tags"><a href="https://www.juev.org/tags/#github" title="View posts tagged with &quot;github&quot;" rel="nofollow">#github</a><a href="https://www.juev.org/tags/#git" title="View posts tagged with &quot;git&quot;" rel="nofollow">#git</a><a href="https://www.juev.org/tags/#web" title="View posts tagged with &quot;web&quot;" rel="nofollow">#web</a><a href="https://www.juev.org/tags/#jekyll" title="View posts tagged with &quot;jekyll&quot;" rel="nofollow">#jekyll</a></span>
</div>
<div class="post"><p>OpenShift по умолчанию предоставляет возможность использовать на своем аккаунте только три приложения. И как указывается в <a href="https://openshift.redhat.com/community/faq#t2n39" title="FAQs - OpenShift by Red Hat">FAQ</a>, для использования большего числа приложений необходимо просто зарегистрировать дополнительные аккаунты.</p>

<p>В качестве одного из приложений у меня выступала моя визитка, состоящая только из одной страницы. Я посчитал расточительством размещать ее на столь мощном сервере, при этом отнимая у меня возможность размещения дополнительных приложений без регистрации дополнительных аккаунтов. И решил перенести визитку на сервер GitHub.</p>

<p>На серверах GitHub можно размещать сайты двумя способами – во первых, это создавать репозиторий с именем username.github.com, где username это имя логина. И в этом репозитории размещаются либо готовые html-файлы, либо движок jekyll. И второй способ – это создание произвольного репозитория, в котором создается дополнительная ветка <code class="highlighter-rouge">gh-pages</code>, в которой будут размещаться сгенерированные html-файлы. Так как у меня репозиторий уже существовал (<a href="https://github.com/Juev/denis.evsyukov.org">denis.evsyukov.org</a>), оставалось использовать только второй вариант. При этом можно было проверить, можно ли размещать на pages.github.com несколько сайтов.</p>

<p>В качестве движка для своей визитки я использовал Jekyll, о котором уже не раз писал на страницах своего сайта (<a href="/tags/jekyll">tag:Jekyll</a>). А в качестве образца я использовал код движка <a href="http://octopress.org/" title="Octopress">Octopress</a>, взяв из него сам принцип публикации.</p>

<p>Создаем в корне своео репозитория директорию <code class="highlighter-rouge">_deploy</code>, и добавляем ее сразу в файл <code class="highlighter-rouge">.gitignore</code>. В данной директории будет размещаться еще один git-репозиторий, с помощью которого будет осуществляться публикация сайта в отдельную ветку нашего репозитория. Итак, даем следующие команды:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ cd repo
$ mkdir _deploy
$ cd _deploy
$ git init
$ git add .
$ git commit -m "Init gh-pages"
$ git branch -m gh-pages
$ git remote add origin #repo_url#
</code></pre></div></div>

<p>В последней строке вместо <code class="highlighter-rouge">#repo_url#</code> нужно указать url-адрес своего репозитория. При этом адрес репозитория нужно брать с SSH, а не https протоколом. При этом для публикации будут использоваться ключи, а не спрашиваться каждый раз имя пользователя и пароль, что, на мой взгляд, гораздо удобнее. И по сути на этом предварительная работа закончена, репозиторий готов к публикации, осталось только изменить одну задачу в файле <code class="highlighter-rouge">Rakefile</code>.</p>

<p>Для начала стоит в начале файла определить несколько переменных:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>domain          = "denis.evsyukov.org"

public_dir      = "public"    # compiled site directory
source_dir      = "source"    # source file directory
deploy_dir      = "_deploy"   # deploy directory (for Github pages deployment)

deploy_branch   = "gh-pages"
deploy_default  = "push"
</code></pre></div></div>

<p>Обратите внимание на то, что я использую структуру директорий из octopress, а не из классического jekyll, на мой взгляд, она более удобная для восприятия и работы. Отличия заключаются в том, что исходный код сайта размещается не в корне, а в директории <code class="highlighter-rouge">source</code>. И генерация производится не в директорию <code class="highlighter-rouge">_site</code>, а в <code class="highlighter-rouge">public</code>. Что помимо прочего позволяет использовать jekyll с целым рядом сторонних движков и веб-серверов.</p>

<p>И теперь определяем задачу для размещения готового сайта на сервере GitHub:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>desc 'Build, deploy.'
task :deploy =&gt; :build do
#  Rake::Task[:copydot].invoke(source_dir, public_dir)
  Rake::Task["#{deploy_default}"].execute
end

desc "copy dot files for deployment"
task :copydot, :source, :dest do |t, args|
  exclusions = [".", "..", ".DS_Store"]
  Dir["#{args.source}/**/.*"].each do |file|
    if !File.directory?(file) &amp;&amp; !exclusions.include?(File.basename(file))
      cp(file, file.gsub(/#{args.source}/, "#{args.dest}"));
    end
  end
end

desc "deploy public directory to github pages"
multitask :push do
  puts "## Deploying branch to Github Pages "
  (Dir["#{deploy_dir}/*"]).each { |f| rm_rf(f) }
  Rake::Task[:copydot].invoke(public_dir, deploy_dir)
  puts "\n## copying #{public_dir} to #{deploy_dir}"
  cp_r "#{public_dir}/.", deploy_dir
  cd "#{deploy_dir}" do
    system "git add ."
    system "git add -u"
    puts "\n## Commiting: Site updated at #{Time.now.utc}"
    message = "Site updated at #{Time.now.utc}"
    system "git commit -m \"#{message}\""
    puts "\n## Pushing generated #{deploy_dir} website"
    system "git push origin #{deploy_branch} --force"
    puts "\n## Github Pages deploy complete"
  end
end
</code></pre></div></div>

<p>Первая задача <code class="highlighter-rouge">:deploy</code> только вызывает задачу <code class="highlighter-rouge">:push</code>, можно было бы и без нее обойтись, но именно с ее помощью можно будет в дальнейшем значительно упростить изменение метода размещения сайта. Достаточно будет прописать новую задачу и использовать ее имя в переменной <code class="highlighter-rouge">deploy_default</code>. Задача <code class="highlighter-rouge">copydot</code> призвана после генерации сайта производить копирование файлов из директории <code class="highlighter-rouge">public</code> в директорию <code class="highlighter-rouge">_deploy</code>, после чего <code class="highlighter-rouge">:push</code> заканчивает весь процесс, обновляя git-репозиторий в директории <code class="highlighter-rouge">_deploy</code> и публикуя его на сервере.</p>

<p>Теперь осталось только в директории <code class="highlighter-rouge">source</code> создать файл <code class="highlighter-rouge">CNAME</code>, в котором прописывается необходимый домен. Запускаем генерацию сайта и его публикацию на сервере github:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ rake deploy
</code></pre></div></div>

<p>После чего остается только изменить dns-зону у нашего домена. Для домена создается <strong>A record</strong> со значением <code class="highlighter-rouge">204.232.175.78</code>. Теперь ждем обновления зоны и наблюдаем свой рабочий сайт уже на сервере GitHub.</p>

<p>Таким образом на сервере GitHub можно размещать любое число сайтов. И если раньше стояли ограничения на объем используемых репозиториев, то с недавних пор и это <a href="https://help.github.com/articles/what-is-my-disk-quota">ограничение убрали</a>. Таким образом GitHub остается идеальным вариантом для размещения статических сайтов. А для использования rails, django и им подобным, стоит обратить внимание на <a href="/2012/05/28/jekyll-in-openshift/" title="Jekyll in OpenShift">OpenShift</a>.</p>
</div>
<div class="meta"><div class="pagination">
 <p class="previous">Previous post: <a rel="prev" href="https://www.juev.org/2012/05/28/jekyll-in-openshift/" title="View Jekyll in OpenShift">Jekyll in OpenShift</a></p>
 <p class="next">Next post: <a rel="next" href="https://www.juev.org/2012/06/09/ipod/" title="View Лучшие программы для iPod Touch">Лучшие программы для iPod Touch</a></p></div>
</div>
</div>
  </div><!-- noindex -->
  <div class="footer">
    <div class="width-fix">
      <p><a href="https://www.juev.org/articles.html" rel="nofollow">Список статей</a> :: <a href="https://www.juev.org/recommendations/" rel="nofollow">Рекомендации</a> :: <a href="https://www.juev.org/atom.xml" rel="nofollow">RSS</a></p>
      <p>&copy;&nbsp;<a href="https://denis.evsyukov.org">Denis Evsyukov</a>,&nbsp;2008&ndash;2019&nbsp;Contact me via <script type="text/javascript">document.write("<n uers=\"znvygb:qravf\100riflhxbi\056bet\">Rznvy</n>".replace(/[a-zA-Z]/g,function(c){return String.fromCharCode((c<="Z"?90:122)>=(c=c.charCodeAt(0)+13)?c:c-26);}));</script>,&nbsp;
      <a href="https://twitter.com/#!/Juev" rel="nofollow">twitter</a> or&nbsp;
      <a href="https://github.com/Juev" rel="nofollow">github</a></p>
    </div>
  </div>
  <script async src="https://static.juev.org/assets/js/master.a08e4d4f.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-26480484-5', 'auto');
    ga('send', 'pageview');
  </script>
</body>
</html>
