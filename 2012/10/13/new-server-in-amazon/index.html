<!DOCTYPE html>
<!--
    You can email me with PGP-key: 0xE8ADA1A55B3CA4EA
-->
<html lang="ru">
<head>
  <link rel="dns-prefetch" href="https://static.juev.org">
  <meta charset="utf-8">
  <title>Создание веб-сервера на амазоне</title>
  <meta name="description" content="Для проведения ряда экспериментов в вебе решил организовать свой сервер.  А так как у меня уже оплачен reserved instances на амазоне, то решил воспользоваться именно им. Техническая задача простая ...">
  <meta name="yandex-verification" content="59bb4b98872e096b" />
  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- end -->
  <link rel="canonical" href="https://www.juev.org/2012/10/13/new-server-in-amazon/">
  <link rel="shortcut icon" href="https://static.juev.org/favicon.ico">
  <link rel="apple-touch-icon" href="https://www.juev.org/apple-touch-icon.png">
  <link rel="alternate" type="application/atom+xml" title="ATOM Feed" href="https://www.juev.org/atom.xml">
  <link rel="stylesheet" type="text/css" href="https://static.juev.org/assets/css/master.6bbfa8b61.css">
  <link rel="prev" href="https://www.juev.org/2012/09/29/clean-desktop/">
  <link rel="next" href="https://www.juev.org/2012/10/20/safari-duckduckgo/">
  <!-- og:meta -->
  <meta content="Создание веб-сервера на амазоне" property="og:title">
  <meta content="Для проведения ряда экспериментов в вебе решил организовать свой сервер.  А так как у меня уже оплачен reserved instances на амазоне, то решил воспользоваться именно им. Техническая задача простая ..." property="og:description">
  <meta content="https://www.juev.org/2012/10/13/new-server-in-amazon/" property="og:url">
  <meta content="2012-10-13T18:40:00+04:00" property="article:published_time">
  <meta content="amazon" property="article:tag">
  <meta content="vps" property="article:tag">
  <meta content="server" property="article:tag">
  <meta content="https://static.juev.org/images/calvin.png" property="og:image">
  <meta content="https://denis.evsyukov.org" property="article:author">
  <!-- end og:meta  -->
  <!-- twitter card -->
  <meta content="summary_large_image" name="twitter:card">
  <meta content="Создание веб-сервера на амазоне" name="twitter:title">
  <meta content="Для проведения ряда экспериментов в вебе решил организовать свой сервер.  А так как у меня уже оплачен reserved instances на амазоне, то решил воспользоваться именно им. Техническая задача простая ..." property="twitter:description">
  <meta content="https://www.juev.org/2012/10/13/new-server-in-amazon/" name="twitter:url">
  <meta content="https://static.juev.org/images/calvin.png" property="twitter:image:src">
  <!-- end twitter card -->
</head>
<body class="wide">
  <div class="navigation">
    <div class="width-fix">
        <a href="https://www.juev.org/" id="home" rel="nofollow"></a>
      <ul>
        <li><a href="https://www.juev.org/articles.html" rel="nofollow">Статьи</a></li>
        <li>|</li>
        <li><a href="https://denis.evsyukov.org">Об авторе</a></li>
      </ul>
    </div>
  </div>
  <div class="primary-content width-fix">
    <div class="entry"><h1 class="title">Создание веб-сервера на амазоне</h1>
<div id="metainfo">
<span class="date">13 October 2012</span>
<span class="tags"><a href="https://www.juev.org/tags/#amazon" title="View posts tagged with &quot;amazon&quot;" rel="nofollow">#amazon</a><a href="https://www.juev.org/tags/#vps" title="View posts tagged with &quot;vps&quot;" rel="nofollow">#vps</a><a href="https://www.juev.org/tags/#server" title="View posts tagged with &quot;server&quot;" rel="nofollow">#server</a></span>
</div>
<div class="post"><p>Для проведения ряда экспериментов в вебе решил организовать свой сервер. А так как у меня уже оплачен <a href="http://aws.amazon.com/ec2/reserved-instances/">reserved instances</a> на амазоне, то решил воспользоваться именно им.</p>

<p>Техническая задача простая – нужно организовать работу веб-сервера с достаточным уровнем безопасности.</p>

<p>На странице <a href="https://console.aws.amazon.com/console/home">Management Console</a> создаем новый сервер.</p>

<p><a href="https://static.juev.org/2012/10/ec2-management-console.png"><img src="https://static.juev.org/2012/10/ec2-management-console-th.png" alt="ec2-management-console" /></a></p>

<p>Используем кнопку Launch instance и отвечаем на несколько вопросов.</p>

<p><a href="https://static.juev.org/2012/10/aws-launch-ec2.png"><img src="https://static.juev.org/2012/10/aws-launch-ec2.png" alt="aws-launch-ec2" /></a></p>

<p>Нужно указать имя нового сервера, сгенерировать ключи для доступа к нему и выбрать образ с операционной системой. На следующем шаге уточняем зону, в которой будет запускаться сервер и определяем группу безопасности. На данном этапе создаем свою группу, в которой открыты для доступа извне только 22 и 80 порты, которые нужны для работы ssh и веб-сервера.</p>

<p><a href="https://static.juev.org/2012/10/security-groups.png"><img src="https://static.juev.org/2012/10/security-groups-th.png" alt="security-groups" /></a></p>

<p>Через пары минут сервер уже готов к работе. И первым делом необходимо зарезервировать ip-адрес, который будет использоваться постоянно за этим сервером. В противном случае после каждой перезагрузки сервера будет выдаваться динамический адрес. И возникнут сложности при работе с доменными именами. Для этого в консоли необходимо перейти в раздел Elastic IPs и произвести выделение нового ip-адреса. После чего остается только привязать его к созданному серверу.</p>

<p><a href="https://static.juev.org/2012/10/elastic-ips.png"><img src="https://static.juev.org/2012/10/elastic-ips-th.png" alt="elastic-ips" /></a></p>

<p>Теперь производим подключение к серверу по ssh. Предварительно рекомендую добавить опции подключения в файл <code class="highlighter-rouge">~/.ssh/config</code>:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Host ec2
HostName 8.8.8.8
User ubuntu
IdentityFile ~/.ssh/mykey.pem
Port 22
</code></pre></div></div>

<p>В первой строке определяется имя сервера, по которому будет производиться подключение, во второй строке определяется или домен или ip-адрес сервера. В третьей строке определяется имя пользователя (для серверов на операционной системе ubuntu по умолчанию используется пользователь ubuntu). Следующей строкой определяем имя файла, в котором располагается ключ, который был загружен в момент создания сервера и самая последняя строка определяет порт, по которому производиться подключение.</p>

<p>Добавили конфигурацию и теперь можно входить на сервер простой командой в терминале:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ ssh ec2
</code></pre></div></div>

<p>Сначала необходимо создать русскую локализацию и установить часовой пояс:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ sudo apt-get update
$ sudo locale-gen ru_RU.UTF8
$ sudo dpkg-reconfigure tzdata
</code></pre></div></div>

<p>Из списка выбираем нужную нам зону, после чего устанавливаем сервер точного времени <code class="highlighter-rouge">openntpd</code>:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ sudo apt-get install openntpd
</code></pre></div></div>

<p>Безопасность уже находиться на очень высоком уровне, извне доступны только два порта, сетевой экран дополнительно настраивать нет необходимости, за этим следит политика безопасности амазона. Вход на сервер производиться только по ключу, но все таки стоит показать любопытным, что им тут делать нечего. Для этого установим denyhosts, про который я писал в статье <a href="/2011/01/15/denyhost-security-server/">DenyHost на страже сервера</a>:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ sudo apt-get install denyhosts
</code></pre></div></div>

<p>Можно оставить настройки по умолчанию, а можно немного с ними поиграться, за дополнительными сведениями отправляю к указанной выше статье.</p>

<p>Теперь осталось установить apache:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ sudo apt-get install apache2
$ sudo a2enmod expires
$ sudo a2enmod headers
$ sudo a2enmod rewrite
$ sudo service apache2 restart
</code></pre></div></div>

<p>Все готово для создания сайтов, за основу берем конфигурацию по умолчанию:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ cd /etc/apache2/sites-available/
$ cp default site1
$ cp default site2
</code></pre></div></div>

<p>Убираем и добавляем те опции, что нам необходимы для работы и активируем созданные сайты:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ sudo a2ensite site1
$ sudo a2ensite site2
$ sudo service apache2 reload
</code></pre></div></div>

<p>На этом все, достаточно только в панели регистратора доменных имен указать ip-адрес созданного сервера.
Амазон предоставляет уникальный сервис с очень дешевыми серверами, которые быстро запускаются и которыми очень просто управлять.</p>
</div>
<div class="meta"><div class="pagination">
 <p class="previous">Previous post: <a rel="prev" href="https://www.juev.org/2012/09/29/clean-desktop/" title="View Clean Desktop">Clean Desktop</a></p>
 <p class="next">Next post: <a rel="next" href="https://www.juev.org/2012/10/20/safari-duckduckgo/" title="View DuckDuckGo в Safari">DuckDuckGo в Safari</a></p></div>
</div>
</div>
  </div><!-- noindex -->
  <div class="footer">
    <div class="width-fix">
      <p><a href="https://www.juev.org/articles.html" rel="nofollow">Список статей</a> :: <a href="https://www.juev.org/recommendations/" rel="nofollow">Рекомендации</a> :: <a href="https://www.juev.org/atom.xml" rel="nofollow">RSS</a></p>
      <p>&copy;&nbsp;<a href="https://denis.evsyukov.org">Denis Evsyukov</a>,&nbsp;2008&ndash;2019&nbsp;Contact me via <script type="text/javascript">document.write("<n uers=\"znvygb:qravf\100riflhxbi\056bet\">Rznvy</n>".replace(/[a-zA-Z]/g,function(c){return String.fromCharCode((c<="Z"?90:122)>=(c=c.charCodeAt(0)+13)?c:c-26);}));</script>,&nbsp;
      <a href="https://twitter.com/#!/Juev" rel="nofollow">twitter</a> or&nbsp;
      <a href="https://github.com/Juev" rel="nofollow">github</a></p>
    </div>
  </div>
  <script async src="https://static.juev.org/assets/js/master.a08e4d4f.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-26480484-5', 'auto');
    ga('send', 'pageview');
  </script>
</body>
</html>
