<!DOCTYPE html>
<!--
    You can email me with PGP-key: 0xE8ADA1A55B3CA4EA
-->
<html lang="ru">
<head>
  <link rel="dns-prefetch" href="https://static.juev.org">
  <meta charset="utf-8">
  <title>Установка Miniflux в Ubuntu 12.04</title>
  <meta name="description" content="В тот момент, как появилась новость о закрытии Google Reader, во всю властвовал Feedly.  Из всех предложенных вариантов он оказался самым интересным, и я просто перенес все свои подписки в данный с...">
  <meta name="yandex-verification" content="59bb4b98872e096b" />
  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- end -->
  <link rel="canonical" href="https://www.juev.org/2013/09/01/miniflux/">
  <link rel="shortcut icon" href="https://static.juev.org/favicon.ico">
  <link rel="apple-touch-icon" href="https://www.juev.org/apple-touch-icon.png">
  <link rel="alternate" type="application/atom+xml" title="ATOM Feed" href="https://www.juev.org/atom.xml">
  <link rel="stylesheet" type="text/css" href="https://static.juev.org/assets/css/master.6bbfa8b61.css">
  <link rel="prev" href="https://www.juev.org/2013/07/18/codekit-for-windows/">
  <link rel="next" href="https://www.juev.org/2013/11/02/home-screen/">
  <!-- og:meta -->
  <meta content="Установка Miniflux в Ubuntu 12.04" property="og:title">
  <meta content="В тот момент, как появилась новость о закрытии Google Reader, во всю властвовал Feedly.  Из всех предложенных вариантов он оказался самым интересным, и я просто перенес все свои подписки в данный с..." property="og:description">
  <meta content="https://www.juev.org/2013/09/01/miniflux/" property="og:url">
  <meta content="2013-09-01T14:34:00+04:00" property="article:published_time">
  <meta content="vps" property="article:tag">
  <meta content="nginx" property="article:tag">
  <meta content="services" property="article:tag">
  <meta content="ubuntu" property="article:tag">
  <meta content="https://static.juev.org/images/calvin.png" property="og:image">
  <meta content="https://denis.evsyukov.org" property="article:author">
  <!-- end og:meta  -->
  <!-- twitter card -->
  <meta content="summary_large_image" name="twitter:card">
  <meta content="Установка Miniflux в Ubuntu 12.04" name="twitter:title">
  <meta content="В тот момент, как появилась новость о закрытии Google Reader, во всю властвовал Feedly.  Из всех предложенных вариантов он оказался самым интересным, и я просто перенес все свои подписки в данный с..." property="twitter:description">
  <meta content="https://www.juev.org/2013/09/01/miniflux/" name="twitter:url">
  <meta content="https://static.juev.org/images/calvin.png" property="twitter:image:src">
  <!-- end twitter card -->
</head>
<body class="wide">
  <div class="navigation">
    <div class="width-fix">
        <a href="https://www.juev.org/" id="home" rel="nofollow"></a>
      <ul>
        <li><a href="https://www.juev.org/articles.html" rel="nofollow">Статьи</a></li>
        <li>|</li>
        <li><a href="https://denis.evsyukov.org">Об авторе</a></li>
      </ul>
    </div>
  </div>
  <div class="primary-content width-fix">
    <div class="entry"><h1 class="title">Установка Miniflux в Ubuntu 12.04</h1>
<div id="metainfo">
<span class="date">01 September 2013</span>
<span class="tags"><a href="https://www.juev.org/tags/#vps" title="View posts tagged with &quot;vps&quot;" rel="nofollow">#vps</a><a href="https://www.juev.org/tags/#nginx" title="View posts tagged with &quot;nginx&quot;" rel="nofollow">#nginx</a><a href="https://www.juev.org/tags/#services" title="View posts tagged with &quot;services&quot;" rel="nofollow">#services</a><a href="https://www.juev.org/tags/#ubuntu" title="View posts tagged with &quot;ubuntu&quot;" rel="nofollow">#ubuntu</a></span>
</div>
<div class="post"><p>В тот момент, как появилась новость о закрытии Google Reader, во всю властвовал Feedly. Из всех предложенных вариантов он оказался самым интересным, и я просто перенес все свои подписки в данный сервис. Кстати, и сейчас я в нем не разочарован.</p>

<p>Но, как обычно это бывает, захотелось странного. И решил попробовать <a href="http://miniflux.net/" title="Miniflux is a minimalist and open source rss reader">miniflux</a>.</p>

<p><a href="https://static.juev.org/2013/09/miniflux.png" title="Miniflux"><img src="https://static.juev.org/2013/09/miniflux-th.jpg" alt="miniflux" /></a></p>

<p>Есть два варианта его использования:</p>

<ol>
  <li>Заплатить единоразово 10 евро и использовать miniflux на хостинге разработчика</li>
  <li>Установить miniflux на свой сервер</li>
</ol>

<p>Проще всего, конечно, заплатить. Так как не нужно будет думать о работоспособности сервера, его оплате, не нужно будет обновлять miniflux, за этим следит сам разработчик. Но мне показалось это не интересным. Сервер-то у меня уже есть.</p>

<p>Буду предполагать, что на сервере еще ничего не установлено, и была только произведена базовая настройка по безопасности и обновлению системы. Приступим:</p>

<ol>
  <li>
    <p>Установим nginx:</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> $ sudo add-apt-repository ppa:nginx/stable
 $ sudo apt-get update
 $ sudo apt-get upgrade --show-upgraded
 $ sudo apt-get install nginx
</code></pre></div>    </div>
  </li>
  <li>
    <p>Установим php5:</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> $ sudo apt-get install php5-fpm php5-sqlite php-xml-parser php-xml-serializer
</code></pre></div>    </div>
  </li>
  <li>
    <p>Настраиваем php5 и его связку с nginx:</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> $ sudo vim /etc/php5/fpm/php.ini
</code></pre></div>    </div>

    <p>Ищем строку с <code class="highlighter-rouge">date.timezone</code>, снимаем с нее комментарий и приводим к следующему виду:</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> date.timezone = "Europe/Moscow"
</code></pre></div>    </div>

    <p>Естественно, что в значении указываете свой часовой пояс. Теперь аналогичные изменения производим в файле <code class="highlighter-rouge">/etc/php5/cli/php.ini</code>. Теперь меняем поведение php5 с прослушивания tcp-соединения на использование сокетов:</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> $ sudo vim /etc/php5/fpm/pool.d/www.conf
</code></pre></div>    </div>

    <p>В этом файле ищем строку <code class="highlighter-rouge">listen = 127.0.0.1:9000</code>, комментируем ее или просто меняем на:</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> listen = /var/run/php5-fpm.sock
</code></pre></div>    </div>

    <p>Остается перезапустить php5, чтобы использовать новые настройки:</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> $ sudo service php5-fpm restart
</code></pre></div>    </div>

    <p>И теперь остается создать новый сайт в nginx, для это выполняем следующие команды:</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> $ cd /etc/nginx/site-available
 $ sudo vim sitename
</code></pre></div>    </div>

    <p>Новый файл приводим примерно к следующему виду, большинство настроек понятны из контекста:</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> server {
     listen 80;
     server_name sitename.ru;

     root /home/username/www/miniflux;
     index index.php;
     autoindex off;

     charset utf-8;

     location / {
         try_files $uri $uri/ =404;
     }

     access_log  off;
     error_log   /home/username/logs/miniflux/error.log;

     location ~ /\. {
         deny all;
         access_log      off;
         log_not_found   off;
     }

     location ~ /data {
         deny all;
         access_log      off;
         log_not_found   off;
     }

     location ~ \.php$ {
         fastcgi_pass unix:/var/run/php5-fpm.sock;
         fastcgi_index index.php;
         include fastcgi_params;
     }
 }
</code></pre></div>    </div>

    <p>Теперь создаем используемые в конфигурации директории:</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> $ mkdir -p ~/www/miniflux ~/logs/miniflux
</code></pre></div>    </div>

    <p>Активируем новую конфигурацию сайта и перезапускаем nginx:</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> $ sudo ln -s /etc/nginx/sites-available/sitename /etc/nginx/sites-enabled
 $ sudo service nginx restart
</code></pre></div>    </div>
  </li>
  <li>
    <p>Устанавливаем miniflux:</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> $ cd ~/www/miniflux
 $ wget https://github.com/fguillot/miniflux/archive/master.zip
 $ sudo apt-get install unzip
 $ unzip master.zip
 $ mv miniflux-master/* .
 $ rm -rf master.zip miniflux-master
</code></pre></div>    </div>
  </li>
</ol>

<p>Собственно на этом все. Остается только у своего доменного регистратора прописать на используемый sitename.ru требуемый ip-адрес, дождаться его делегирования, и можно открывать уже свой ридер в браузере.</p>

<p>Для первого входа в систему используется учетные данные: <code class="highlighter-rouge">admin/admin</code>. После входа нужно в настройках их изменить и импортировать свой opml-файл с rss-подписками.</p>

<p>Обновление подписок производится вручную, либо можно использовать crontab для обновления по времени, для это используется команда:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ crontab -e
</code></pre></div></div>

<p>И в открывшемся файле добавляем строку:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>*/20 * * * * cd /home/ubuntu/www/miniflux &amp;&amp; php cronjob.php &gt; /dev/null 2&gt;&amp;1
</code></pre></div></div>

<p>Согласно данной настройке, обновление лент будет производиться каждые 20 минут.</p>

<p>В целом, miniflux мне очень понравился тем, что он очень легкий, быстрый, имеет управление с клавиатуры. Плюс в нем очень просто настраивать оформление статей. Я после первого же запуска изменил используемые шрифты, отцентровал изображения в статьях (как это выглядит сейчас можно посмотреть на изображении в начале статьи). А фиды для помеченных статей подключил в ifttt, создал правило, по которому при появлении в данном фиде статьи, добавлять ее в instapaper.</p>

<p>Просто и удобно!</p>
</div>
<div class="meta"><div class="pagination">
 <p class="previous">Previous post: <a rel="prev" href="https://www.juev.org/2013/07/18/codekit-for-windows/" title="View Codekit for Windows">Codekit for Windows</a></p>
 <p class="next">Next post: <a rel="next" href="https://www.juev.org/2013/11/02/home-screen/" title="View Home Screen: Denis Evsyukov">Home Screen: Denis Evsyukov</a></p></div>
</div>
</div>
  </div><!-- noindex -->
  <div class="footer">
    <div class="width-fix">
      <p><a href="https://www.juev.org/articles.html" rel="nofollow">Список статей</a> :: <a href="https://www.juev.org/recommendations/" rel="nofollow">Рекомендации</a> :: <a href="https://www.juev.org/atom.xml" rel="nofollow">RSS</a></p>
      <p>&copy;&nbsp;<a href="https://denis.evsyukov.org">Denis Evsyukov</a>,&nbsp;2008&ndash;2019&nbsp;Contact me via <script type="text/javascript">document.write("<n uers=\"znvygb:qravf\100riflhxbi\056bet\">Rznvy</n>".replace(/[a-zA-Z]/g,function(c){return String.fromCharCode((c<="Z"?90:122)>=(c=c.charCodeAt(0)+13)?c:c-26);}));</script>,&nbsp;
      <a href="https://twitter.com/#!/Juev" rel="nofollow">twitter</a> or&nbsp;
      <a href="https://github.com/Juev" rel="nofollow">github</a></p>
    </div>
  </div>
  <script async src="https://static.juev.org/assets/js/master.a08e4d4f.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-26480484-5', 'auto');
    ga('send', 'pageview');
  </script>
</body>
</html>
